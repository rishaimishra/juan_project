let countryData = {
  message: "Countries fetched successfully.",
  data: [
    {
      id: 205,
      nombre: "España",
      cod: "ES",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 142,
      nombre: "México",
      cod: "MX",
      moneda: "MXN",
      activo: 1,
    },
    {
      id: 7,
      nombre: "Anguilla",
      cod: "AI",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 9,
      nombre: "Antigua & Barbuda",
      cod: "AG",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 10,
      nombre: "Argentina",
      cod: "AG",
      moneda: "ARS",
      activo: 1,
    },
    {
      id: 12,
      nombre: "Aruba",
      cod: "AW",
      moneda: "AWG",
      activo: 1,
    },
    {
      id: 16,
      nombre: "Bahamas",
      cod: "BS",
      moneda: "BSD",
      activo: 1,
    },
    {
      id: 19,
      nombre: "Barbados",
      cod: "BB",
      moneda: "BBD",
      activo: 1,
    },
    {
      id: 22,
      nombre: "Belize",
      cod: "BZ",
      moneda: "BZ",
      activo: 1,
    },
    {
      id: 24,
      nombre: "Bermuda",
      cod: "BM",
      moneda: "BMD",
      activo: 1,
    },
    {
      id: 26,
      nombre: "Bolivia",
      cod: "BO",
      moneda: "BOB",
      activo: 1,
    },
    {
      id: 30,
      nombre: "Brazil",
      cod: "BR",
      moneda: "BRL",
      activo: 1,
    },
    {
      id: 239,
      nombre: "Virgin Islands (UK)",
      cod: "VG",
      moneda: "USD",
      activo: 1,
    },
    {
      id: 38,
      nombre: "Canada",
      cod: "CA",
      moneda: "CAD",
      activo: 1,
    },
    {
      id: 40,
      nombre: "Cayman Islands",
      cod: "KY",
      moneda: "KYD",
      activo: 1,
    },
    {
      id: 43,
      nombre: "Chile",
      cod: "CL",
      moneda: "CLP",
      activo: 1,
    },
    {
      id: 47,
      nombre: "Colombia",
      cod: "CO",
      moneda: "COP",
      activo: 1,
    },
    {
      id: 52,
      nombre: "Costa Rica",
      cod: "CR",
      moneda: "CRC",
      activo: 1,
    },
    {
      id: 60,
      nombre: "Dominica",
      cod: "DM",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 61,
      nombre: "República Dominicana",
      cod: "DO",
      moneda: "DOP",
      activo: 1,
    },
    {
      id: 63,
      nombre: "Ecuador",
      cod: "EC",
      moneda: "ECS",
      activo: 1,
    },
    {
      id: 65,
      nombre: "El Salvador",
      cod: "SV",
      moneda: "SVC",
      activo: 1,
    },
    {
      id: 71,
      nombre: "Falkland Island",
      cod: "FK",
      moneda: "FKP",
      activo: 1,
    },
    {
      id: 76,
      nombre: "French Guiana",
      cod: "GF",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 86,
      nombre: "Greenland",
      cod: "GL",
      moneda: "DKK",
      activo: 1,
    },
    {
      id: 87,
      nombre: "Grenada",
      cod: "GD",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 88,
      nombre: "Guadeloupe",
      cod: "GP",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 90,
      nombre: "Guatemala",
      cod: "GT",
      moneda: "GTQ",
      activo: 1,
    },
    {
      id: 94,
      nombre: "Guiana",
      cod: "GN",
      moneda: "GYD",
      activo: 1,
    },
    {
      id: 97,
      nombre: "Honduras",
      cod: "HN",
      moneda: "HNL",
      activo: 1,
    },
    {
      id: 108,
      nombre: "Jamaica",
      cod: "JM",
      moneda: "JMD",
      activo: 1,
    },
    {
      id: 138,
      nombre: "Martinique",
      cod: "MQ",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 147,
      nombre: "Montserrat",
      cod: "MS",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 154,
      nombre: "Caribbean Netherlands",
      cod: "",
      moneda: "ANG",
      activo: 1,
    },
    {
      id: 158,
      nombre: "Nicaragua",
      cod: "NI",
      moneda: "NIO",
      activo: 1,
    },
    {
      id: 169,
      nombre: "Panamá",
      cod: "PA",
      moneda: "PAB",
      activo: 1,
    },
    {
      id: 171,
      nombre: "Paraguay",
      cod: "PY",
      moneda: "TIG",
      activo: 1,
    },
    {
      id: 172,
      nombre: "Perú",
      cod: "PE",
      moneda: "PEN",
      activo: 1,
    },
    {
      id: 184,
      nombre: "San Kitts & Nevis",
      cod: "KN",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 185,
      nombre: "Saint Lucia",
      cod: "SL",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 186,
      nombre: "San Pierre et Miquelon",
      cod: "PM",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 187,
      nombre: "Saint  Vicente & the Granadines",
      cod: "VC",
      moneda: "XCD",
      activo: 1,
    },
    {
      id: 208,
      nombre: "Suriname",
      cod: "SW",
      moneda: "SRD",
      activo: 1,
    },
    {
      id: 221,
      nombre: "Trinidad & Tobago",
      cod: "TT",
      moneda: "TTD",
      activo: 1,
    },
    {
      id: 225,
      nombre: "Turks & Caicos Islands",
      cod: "TC",
      moneda: "EOS",
      activo: 1,
    },
    {
      id: 231,
      nombre: "USA",
      cod: "US",
      moneda: "USD",
      activo: 1,
    },
    {
      id: 233,
      nombre: "Uruguay",
      cod: "UY",
      moneda: "UYU",
      activo: 1,
    },
    {
      id: 237,
      nombre: "Venezuela",
      cod: "VE",
      moneda: "VEF",
      activo: 1,
    },
    {
      id: 2,
      nombre: "Albania",
      cod: "AL",
      moneda: "ALL",
      activo: 1,
    },
    {
      id: 5,
      nombre: "Andorra",
      cod: "AD",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 14,
      nombre: "Austria",
      cod: "AT",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 15,
      nombre: "Azerbaijan",
      cod: "AZ",
      moneda: "AZN",
      activo: 1,
    },
    {
      id: 20,
      nombre: "Belarus",
      cod: "BY",
      moneda: "BYN",
      activo: 1,
    },
    {
      id: 21,
      nombre: "Belgium",
      cod: "BE",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 27,
      nombre: "Bosnia & Herzegovina",
      cod: "BA",
      moneda: "BAM",
      activo: 1,
    },
    {
      id: 33,
      nombre: "Bulgary",
      cod: "BG",
      moneda: "BGN",
      activo: 1,
    },
    {
      id: 54,
      nombre: "Croatia",
      cod: "HR",
      moneda: "HRK",
      activo: 1,
    },
    {
      id: 56,
      nombre: "Cyprus",
      cod: "CY",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 57,
      nombre: "Czech Republic",
      cod: "CZ",
      moneda: "CZK",
      activo: 1,
    },
    {
      id: 58,
      nombre: "Denmark",
      cod: "DK",
      moneda: "DKK",
      activo: 1,
    },
    {
      id: 68,
      nombre: "Estonia",
      cod: "EE",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 72,
      nombre: "Feroe Islands",
      cod: "FO",
      moneda: "DKK",
      activo: 1,
    },
    {
      id: 74,
      nombre: "Finland",
      cod: "FI",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 75,
      nombre: "France",
      cod: "FR",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 81,
      nombre: "Georgia",
      cod: "GE",
      moneda: "GEL",
      activo: 1,
    },
    {
      id: 82,
      nombre: "Germany",
      cod: "DE",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 84,
      nombre: "Gibraltar",
      cod: "GI",
      moneda: "GIP",
      activo: 1,
    },
    {
      id: 85,
      nombre: "Greece",
      cod: "GR",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 99,
      nombre: "Hungary",
      cod: "HU",
      moneda: "HUF",
      activo: 1,
    },
    {
      id: 100,
      nombre: "Iceland",
      cod: "IS",
      moneda: "ISK",
      activo: 1,
    },
    {
      id: 105,
      nombre: "Ireland",
      cod: "IE",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 107,
      nombre: "Italy",
      cod: "IT",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 120,
      nombre: "Latvia",
      cod: "LV",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 125,
      nombre: "Liechtenstein",
      cod: "LI",
      moneda: "CHF",
      activo: 1,
    },
    {
      id: 126,
      nombre: "Lithuania",
      cod: "LT",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 127,
      nombre: "Luxemburg",
      cod: "LU",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 129,
      nombre: "Macedonia",
      cod: "MK",
      moneda: "MKD",
      activo: 1,
    },
    {
      id: 135,
      nombre: "Malta",
      cod: "MT",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 144,
      nombre: "Moldova",
      cod: "MD",
      moneda: "MDL",
      activo: 1,
    },
    {
      id: 145,
      nombre: "Monaco",
      cod: "MC",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 299,
      nombre: "Montenegro",
      cod: "ME",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 155,
      nombre: "Netherlands",
      cod: "NL",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 164,
      nombre: "Norway",
      cod: "NO",
      moneda: "NOK",
      activo: 1,
    },
    {
      id: 175,
      nombre: "Poland",
      cod: "PL",
      moneda: "PLN",
      activo: 1,
    },
    {
      id: 176,
      nombre: "Portugal",
      cod: "PT",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 180,
      nombre: "Rumania",
      cod: "RO",
      moneda: "RON",
      activo: 1,
    },
    {
      id: 181,
      nombre: "Russia",
      cod: "RU",
      moneda: "RUB",
      activo: 1,
    },
    {
      id: 189,
      nombre: "San Marino",
      cod: "SM",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 193,
      nombre: "Serbia",
      cod: "RS",
      moneda: "RSD",
      activo: 1,
    },
    {
      id: 197,
      nombre: "Slovakia",
      cod: "SK",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 198,
      nombre: "Slovenia",
      cod: "SI",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 211,
      nombre: "Sweden",
      cod: "SE",
      moneda: "SEK",
      activo: 1,
    },
    {
      id: 212,
      nombre: "Switzerland",
      cod: "CH",
      moneda: "CHF",
      activo: 1,
    },
    {
      id: 228,
      nombre: "Ukraine",
      cod: "UA",
      moneda: "UAH",
      activo: 1,
    },
    {
      id: 230,
      nombre: "United Kingdom",
      cod: "GB",
      moneda: "GBP",
      activo: 1,
    },
    {
      id: 236,
      nombre: "Cità del Vaticano",
      cod: "VA",
      moneda: "EUR",
      activo: 1,
    },
    {
      id: 101,
      nombre: "India",
      cod: "IN",
      moneda: "INR",
      activo: 1,
    },
    {
      id: 223,
      nombre: "Turkey",
      cod: "",
      moneda: "TRY",
      activo: 1,
    },
    {
      id: 109,
      nombre: "Japan",
      cod: "JP",
      moneda: "JPY",
      activo: 1,
    },
    {
      id: 13,
      nombre: "Australia",
      cod: "AU",
      moneda: "AUD",
      activo: 1,
    },
    {
      id: 157,
      nombre: "New Zealand",
      cod: "NZ",
      moneda: "NZD",
      activo: 1,
    },
    {
      id: 148,
      nombre: "Maroc",
      cod: "MA",
      moneda: "MAD",
      activo: 1,
    },
    {
      id: 3,
      nombre: "Algérie",
      cod: "DZ",
      moneda: "DZD",
      activo: 1,
    },
    {
      id: 222,
      nombre: "Tunisie",
      cod: "TN",
      moneda: "TND",
      activo: 1,
    },
    {
      id: 64,
      nombre: "Egypt",
      cod: "EG",
      moneda: "EGP",
      activo: 1,
    },
    {
      id: 202,
      nombre: "South Africa",
      cod: "ZA",
      moneda: "ZAR",
      activo: 1,
    },
    {
      id: 300,
      nombre: "China ",
      cod: "CN",
      moneda: "CNY",
      activo: 1,
    },
    {
      id: 301,
      nombre: "United Arab Emirates",
      cod: "UAE",
      moneda: "AED",
      activo: 1,
    },
    {
      id: 302,
      nombre: "Angola",
      cod: "No",
      moneda: "AO",
      activo: 1,
    },
    {
      id: 303,
      nombre: "Benín",
      cod: "BJ",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 304,
      nombre: "Botsuana",
      cod: "BW",
      moneda: "BWP",
      activo: 1,
    },
    {
      id: 305,
      nombre: "Burkina Faso",
      cod: "BF",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 306,
      nombre: "Burundi",
      cod: "BI",
      moneda: "BIF",
      activo: 1,
    },
    {
      id: 307,
      nombre: "Cabo Verde",
      cod: "CV",
      moneda: "CVE",
      activo: 1,
    },
    {
      id: 308,
      nombre: "Camer'n",
      cod: "CM",
      moneda: "XAF",
      activo: 1,
    },
    {
      id: 309,
      nombre: "Centroafricana (República)",
      cod: "CAF",
      moneda: "XAF",
      activo: 1,
    },
    {
      id: 310,
      nombre: "Comores",
      cod: "KM",
      moneda: "KMF",
      activo: 1,
    },
    {
      id: 311,
      nombre: "Costa de Marfil",
      cod: "CI",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 312,
      nombre: "Chad",
      cod: "TD",
      moneda: "XAF",
      activo: 1,
    },
    {
      id: 313,
      nombre: "Eritrea",
      cod: "ER",
      moneda: "ERN",
      activo: 1,
    },
    {
      id: 314,
      nombre: "Etiopia",
      cod: "ETH",
      moneda: "ETB",
      activo: 1,
    },
    {
      id: 315,
      nombre: "Gabon",
      cod: "GAB",
      moneda: "CFA",
      activo: 1,
    },
    {
      id: 316,
      nombre: "Gambia",
      cod: "GM",
      moneda: "GMD",
      activo: 1,
    },
    {
      id: 317,
      nombre: "Ghana",
      cod: "GH",
      moneda: "GHS",
      activo: 1,
    },
    {
      id: 318,
      nombre: "Guinea",
      cod: "GN",
      moneda: "GNF",
      activo: 1,
    },
    {
      id: 319,
      nombre: "Guinea-Bissau",
      cod: "GB",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 320,
      nombre: "Guinea Ecuatorial",
      cod: "XAF",
      moneda: "GQ",
      activo: 1,
    },
    {
      id: 321,
      nombre: "Kenia",
      cod: "KE",
      moneda: "KES",
      activo: 1,
    },
    {
      id: 322,
      nombre: "Lesoto",
      cod: "LS",
      moneda: "LSL",
      activo: 1,
    },
    {
      id: 323,
      nombre: "Liberia",
      cod: "LR",
      moneda: "LRD",
      activo: 1,
    },
    {
      id: 324,
      nombre: "Libia",
      cod: "LY ",
      moneda: "LYD",
      activo: 1,
    },
    {
      id: 325,
      nombre: "Madagascar",
      cod: "MG ",
      moneda: "MGA",
      activo: 1,
    },
    {
      id: 326,
      nombre: "Malaui",
      cod: "MW",
      moneda: "MWK",
      activo: 1,
    },
    {
      id: 327,
      nombre: "Mali",
      cod: "ML",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 328,
      nombre: "Mauricio",
      cod: "MU",
      moneda: "MUR",
      activo: 1,
    },
    {
      id: 329,
      nombre: "Mauritania",
      cod: "MR ",
      moneda: "MRU",
      activo: 1,
    },
    {
      id: 330,
      nombre: "Mozambique",
      cod: "MZ ",
      moneda: "MZN",
      activo: 1,
    },
    {
      id: 331,
      nombre: "Namibia",
      cod: "NA ",
      moneda: "NAD",
      activo: 1,
    },
    {
      id: 332,
      nombre: "Niger",
      cod: "NE",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 333,
      nombre: "Nigeria",
      cod: "NG ",
      moneda: "NGN",
      activo: 1,
    },
    {
      id: 334,
      nombre: "Ruanda",
      cod: "RW ",
      moneda: "RWF",
      activo: 1,
    },
    {
      id: 335,
      nombre: "Republica del Congo",
      cod: "CG",
      moneda: "XAF",
      activo: 1,
    },
    {
      id: 336,
      nombre: "Republica Democratica del congo",
      cod: "CD ",
      moneda: "CDF",
      activo: 1,
    },
    {
      id: 337,
      nombre: "Santo Tome y Principe",
      cod: "ST ",
      moneda: "STN",
      activo: 1,
    },
    {
      id: 338,
      nombre: "Senegal",
      cod: "XOF",
      moneda: "SN",
      activo: 1,
    },
    {
      id: 339,
      nombre: "Seychelles",
      cod: "SC",
      moneda: "SCR",
      activo: 1,
    },
    {
      id: 340,
      nombre: "Sierra Leona",
      cod: "SL",
      moneda: "SLL",
      activo: 1,
    },
    {
      id: 341,
      nombre: "Somalia",
      cod: "SO",
      moneda: "SOS",
      activo: 1,
    },
    {
      id: 342,
      nombre: "Sudan",
      cod: "SD",
      moneda: "SDG",
      activo: 1,
    },
    {
      id: 343,
      nombre: "Sudan del Sur",
      cod: "SS",
      moneda: "SSP",
      activo: 1,
    },
    {
      id: 344,
      nombre: "Suazilandia",
      cod: "SWZ",
      moneda: "SZL",
      activo: 1,
    },
    {
      id: 345,
      nombre: "Tanzania",
      cod: "TZ",
      moneda: "TZS",
      activo: 1,
    },
    {
      id: 346,
      nombre: "Togo",
      cod: "TG",
      moneda: "XOF",
      activo: 1,
    },
    {
      id: 347,
      nombre: "Uganda",
      cod: "UG",
      moneda: "UGX",
      activo: 1,
    },
    {
      id: 348,
      nombre: "Yibuti",
      cod: "DJ",
      moneda: "DJF",
      activo: 1,
    },
    {
      id: 349,
      nombre: "Zambia",
      cod: "ZM",
      moneda: "ZMW",
      activo: 1,
    },
    {
      id: 350,
      nombre: "Zimbabue",
      cod: "ZW",
      moneda: "RTGS DOLLAR",
      activo: 1,
    },
    {
      id: 351,
      nombre: "Syria",
      cod: "SY",
      moneda: "SYP",
      activo: 1,
    },
    {
      id: 352,
      nombre: "Iraq",
      cod: "IQ",
      moneda: "IQD",
      activo: 1,
    },
    {
      id: 353,
      nombre: "Philippines",
      cod: "PHP",
      moneda: "Peso PHP",
      activo: 1,
    },
  ],
};

$(document).ready(function () {
  setTimeout(() => {
    callCountryListApi();
  }, 2000);

  $("body").on("click", ".get-notified-submit", function () {
    const selector = $(this).attr("data-form-id");
    submitLeadFormHomePage(selector);
  });

  $("body").on("click", "#body-get-notified-form-confirm", function () {
    submitLeadForm("section");
  });

  $("body").on("click", "#modal-form-get-notified", function () {
    submitLeadForm("modal");
  });

  // $(".country").on("click", function (event) {
    $(document).on("change", ".country", function (event) {
      const v = $(this).val();
    
      console.log("Selected Value:", v);
    
      // Get selected option data attributes
      const id = event.target.options[event.target.selectedIndex]?.dataset.id;
      const nombre = event.target.options[event.target.selectedIndex]?.dataset.nombre;
      const cod = event.target.options[event.target.selectedIndex]?.dataset.cod;
    
      console.log("Selected ID:", id);
      console.log("Selected Nombre:", nombre);
      console.log("Selected Cod:", cod);

    // console.log($(this).attr("data-id"));
    // console.log($(this).attr("data-nombre"));
    // console.log($(this).attr("data-cod"));

    callCityListApi(id);
  });

  $(".state").on("click", function () {});
});

function submitLeadForm(prefix) {
  const data = {
    name: $(`#${prefix}_full_name`).val(),
    email: $(`#${prefix}_email_address`).val(),
    phone: $(`#${prefix}_phone_number`).val(),
    country: $(`#${prefix}_country`).val(),
    state: $(`#${prefix}_state`).val(),
    city: $(`#${prefix}_city`).val(),
  };

  // console.log(data);
  // return;

  $.ajax({
    url: `https://bidinproject.com/api/leads`,
    type: "POST",
    dataType: "json",
    data: data,
    success: function (response) {
      console.log(response);
      $("#section_form")[0].reset();
      $("#modal_form")[0].reset();
      // $("#thankYouModal").modal("show");
      // Redirect to Thank You page
      window.location.href = "https://bidinproject.com/contractor-services/thank-you.html"; 
    },
    error: function (error) {
      console.log("API Error: ", error);
  
      if (error.responseJSON && error.responseJSON.errors) {
          let errorMessages = "";
  
          // Loop through the validation errors and display them
          $.each(error.responseJSON.errors, function (key, messages) {
            
              errorMessages += `<p>${messages[0]}</p>`; // Show the first error for each field
          });
          
          $(".error-messagez").html(errorMessages); // Append to an error div
      } else {
          $(".error-messagez").text("An unexpected error occurred.");
      }
  },
    complete: function (data) {
      console.log("api completed");

      $(".modal").modal("hide");

      // $("#thankYouModal").modal("show");
    },
  });
}

function submitLeadFormHomePage(selector) {
  handleFormError(null);
  
  const dateInputField = document.querySelector('.est_time');
  const dateInput = dateInputField ? dateInputField.value : null;
  const formattedDate = dateInput ? `${dateInput}T00:00` : null;
  
  console.log(formattedDate);
  
  
  const data = {
    name: $(`.${selector} .name`).val().trim(),
    // last_name: $(`.${selector} .last_name`).val().trim(),

    address: $(`.${selector} .address`).val().trim(),
    postal_code: $(`.${selector} .postal_code`).val().trim(),

    // country: $(`.${selector} .country`).val(),
    country: $(`.${selector} .country option:selected`).data('id'),

    // state: $(`.${selector} .state`).val(),
    state: $(`.${selector} .state option:selected`).data('id'),

    city: $(`.${selector} .city`).val().trim(),

    mobile_num: $(`.${selector} .mobile_num`).val().trim(),

    email: $(`.${selector} .email`).val().trim(),

    password: $(`.${selector} .password`).val().trim(),
    confirm_password: $(`.${selector} .confirm_password`).val().trim(),

    // opportunity_name: $(`.${selector} .opportunity_name`).val().trim(),
    detail_description: $(`.${selector} .detail_description`).val().trim(),

    est_time: formattedDate,
    // best_time: $(`.${selector} .best_time`).val(),
    best_time : $(`.${selector} .best_time`).val() || null,

    

    language: "en",
  };

  // console.log(data);
  // return;

  $(".get-notified-submit").prop("disabled", true);

  $.ajax({
    url: `https://bidinproject.com/api/add-user-with-job-api`,
    type: "POST",
    dataType: "json",
    contentType: "application/json", // Ensure correct data format
    data: JSON.stringify(data), // Convert JS object to JSON
    success: function (response) {
      console.log(response);

      // reset the forms
      document.querySelector(".section-form-div form").reset();
      document.querySelector(".modal-form-div form").reset();

      console.log("api completed");

      $(".modal").modal("hide");

      // $("#thankYouModal").modal("show");
       // Redirect to Thank You page
       window.location.href = "https://bidinproject.com/contractor-services/thank-you.html"; 
    },
    error: function (error) {
      console.log("API Error: ", error);
  
      if (error.responseJSON && error.responseJSON.errors) {
          let errorMessages = "";
  
          // Loop through the validation errors and display them
          $.each(error.responseJSON.errors, function (key, messages) {
            
              errorMessages += `<p>${messages[0]}</p>`; // Show the first error for each field
          });
          
          $(".error-messagez").html(errorMessages); // Append to an error div
      } else {
          $(".error-messagez").text("An unexpected error occurred.");
      }
  },
  
    complete: function (data) {
      $(".get-notified-submit").prop("disabled", false);
    },
  });
}

function handleFormError(message) {
  if (message == null) {
    $(".form-error-message").text("");
    return;
  }

  $(".form-error-message").text(message);
}

function callCountryListApi() {
  const data = countryData.data;

  // id
  // nombre
  // cod

  drawCountryOptions(data);

  $.ajax({
    url: `https://bidinproject.com/api/paises`,
    type: "GET",
    dataType: "json",
    // data: data,
    success: function (response) {
      console.log(response);
      drawCountryOptions(response.data);
    },
    error: function (error) {
      console.log(error.responseJSON.error);
    },
    complete: function (data) {
      $(".get-notified-submit").prop("disabled", false);
    },
  });
}

function callCityListApi(id) {
  $.ajax({
    url: `https://bidinproject.com/api/provincias/${id}`,
    type: "GET",
    dataType: "json",
    // data: data,
    success: function (response) {
      console.log(response);

      drawCityOptions(response.data);
    },
    error: function (error) {
      console.log(error.responseJSON.error);
    },
    complete: function (data) {
      $(".get-notified-submit").prop("disabled", false);
    },
  });
}

function drawCountryOptions(data) {
  let el = `<option value="" selected disabled>-- choose --</option>`;
  data.forEach((e) => {
    el += `<option value="${e.nombre}" data-id="${e.id}" data-nombre="${e.nombre}" data-cod="${e.cod}">${e.nombre}</option>`;
  });

  $(".country").empty().append(el);
}

function drawCityOptions(data) {
  let el = `<option value="" selected disabled>-- choose --</option>`;
  data.forEach((e) => {
    el += `<option value="${e.nombre}" data-id="${e.id}">${e.nombre}</option>`;
  });

  $(".state").empty().append(el);
}

